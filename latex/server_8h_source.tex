\doxysection{server.\+h}
\hypertarget{server_8h_source}{}\label{server_8h_source}\doxymbox{\hyperlink{server_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Prepared\ for\ BCIT\ ELEX4618,\ April\ 2022,\ by\ Craig\ Hennessey}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ WIN4618}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\#define\ PI4618}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifdef\ PI4618}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <opencv2/opencv.hpp>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{class_c_server_aa3277fb7ded9c4d7a60747805d527c29}{CServer}}}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordtype}{bool}\ \doxymbox{\hyperlink{class_c_server_ad0463f08401dc2a905027aac18f77a7d}{\_server\_exit}};}
\DoxyCodeLine{00022\ \ \ cv::Mat\ \doxymbox{\hyperlink{class_c_server_ae751145e543be16e7b42a3a66774ae95}{\_txim}};}
\DoxyCodeLine{00023\ \ \ }
\DoxyCodeLine{00024\ \ \ std::mutex\ \doxymbox{\hyperlink{class_c_server_a884cb2eaf9cb624d269c36c32ceb5d1c}{\_image\_mutex}};}
\DoxyCodeLine{00025\ \ \ std::mutex\ \doxymbox{\hyperlink{class_c_server_a924a162a591dc548585418bd9172fd73}{\_rx\_mutex}};}
\DoxyCodeLine{00026\ \ \ std::mutex\ \doxymbox{\hyperlink{class_c_server_ac07d5606e9e140540067ce8fbabba976}{\_tx\_mutex}};}
\DoxyCodeLine{00027\ \ \ std::vector<std::string>\ \doxymbox{\hyperlink{class_c_server_ab5be7286809fdd06c173619f379522ec}{\_cmd\_list}};}
\DoxyCodeLine{00028\ \ \ std::vector<std::string>\ \doxymbox{\hyperlink{class_c_server_a55b2611bd6db2ea77541c6ae183950c3}{\_send\_list}};}
\DoxyCodeLine{00029\ \ \ }
\DoxyCodeLine{00030\ \ \ \textcolor{keywordtype}{bool}\ \doxymbox{\hyperlink{class_c_server_ab9ab8a857c7ac985c528d38cf2201b93}{setblocking}}(\textcolor{keywordtype}{int}\ fd,\ \textcolor{keywordtype}{bool}\ blocking);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \doxymbox{\hyperlink{class_c_server_aa3277fb7ded9c4d7a60747805d527c29}{CServer}}();}
\DoxyCodeLine{00034\ \ \ \ \ \doxymbox{\hyperlink{class_c_server_af6da9f8b52bdc049e21cd7c687ef4d4b}{\string~CServer}}();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ Start\ server\ listening\ (probably\ best\ to\ do\ in\ a\ separate\ thread)}}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_c_server_a6ce19d7a0606741610028a065ddddc57}{start}}(\textcolor{keywordtype}{int}\ port);}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_c_server_a31f0e23f00b4e506ab38bff799796358}{stop}}();}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ Set\ the\ image\ to\ transmit}}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_c_server_a169fd953001f33e59cf0175cea094c5a}{set\_txim}}\ (cv::Mat\ \&im);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//\ Get\ a\ vector\ of\ the\ commands\ the\ server\ has\ read}}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_c_server_affba2b34f1f175a9850fa2af53d5b56a}{get\_cmd}}\ (std::vector<std::string>\ \&cmds);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ Send\ a\ response}}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_c_server_a48f94d62c951cc3f92ecc1507507980f}{send\_string}}\ (std::string\ send\_str);}
\DoxyCodeLine{00048\ \};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{/*}}
\DoxyCodeLine{00052\ \textcolor{comment}{NOTE:\ If\ you\ see\ this\ error\ when\ running\ your\ program\ on\ the\ Pi\ then\ follow\ the\ instructions\ below.}}
\DoxyCodeLine{00053\ \textcolor{comment}{}}
\DoxyCodeLine{00054\ \textcolor{comment}{Xlib:\ sequence\ lost(0x10061\ >\ 0x6d)\ in\ reply\ type\ 0x1c!}}
\DoxyCodeLine{00055\ \textcolor{comment}{[xcb]\ Unknown\ request\ in\ queue\ while\ dequeuing}}
\DoxyCodeLine{00056\ \textcolor{comment}{[xcb]\ Most\ likely\ this\ is\ a\ multi\ -\/\ threaded\ client\ and\ XInitThreads\ has\ not\ been\ called}}
\DoxyCodeLine{00057\ \textcolor{comment}{[xcb]\ Aborting,\ sorry\ about\ that.}}
\DoxyCodeLine{00058\ \textcolor{comment}{main\ :\ ..\ /\ ..\ /\ src\ /\ xcb\_io.c\ :\ 165\ :\ dequeue\_pending\_request\ :\ Assertion\ \`{}!xcb\_xlib\_unknown\_req\_in\_deq'\ failed.}}
\DoxyCodeLine{00059\ \textcolor{comment}{2021\ -\/\ 03\ -\/\ 31\ 16:31\ :\ 31\ sigHandler\ :\ Unhandled\ signal\ 6,\ terminating}}
\DoxyCodeLine{00060\ \textcolor{comment}{}}
\DoxyCodeLine{00061\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00062\ \textcolor{comment}{}}
\DoxyCodeLine{00063\ \textcolor{comment}{Install\ X11\ with\ :}}
\DoxyCodeLine{00064\ \textcolor{comment}{}}
\DoxyCodeLine{00065\ \textcolor{comment}{sudo\ apt-\/get\ install\ libx11-\/dev}}
\DoxyCodeLine{00066\ \textcolor{comment}{}}
\DoxyCodeLine{00067\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00068\ \textcolor{comment}{}}
\DoxyCodeLine{00069\ \textcolor{comment}{Include\ X11\ library\ AFTER\ the\ OpenCV\ header:}}
\DoxyCodeLine{00070\ \textcolor{comment}{}}
\DoxyCodeLine{00071\ \textcolor{comment}{\#include\ <opencv2/opencv.hpp>}}
\DoxyCodeLine{00072\ \textcolor{comment}{\#include\ <X11/Xlib.h>}}
\DoxyCodeLine{00073\ \textcolor{comment}{}}
\DoxyCodeLine{00074\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00075\ \textcolor{comment}{}}
\DoxyCodeLine{00076\ \textcolor{comment}{Call\ XInitThreads\ in\ main\ or\ constructor:}}
\DoxyCodeLine{00077\ \textcolor{comment}{}}
\DoxyCodeLine{00078\ \textcolor{comment}{XInitThreads();}}
\DoxyCodeLine{00079\ \textcolor{comment}{}}
\DoxyCodeLine{00080\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00081\ \textcolor{comment}{}}
\DoxyCodeLine{00082\ \textcolor{comment}{Add\ directive\ to\ linker:}}
\DoxyCodeLine{00083\ \textcolor{comment}{-\/\ lX11}}
\DoxyCodeLine{00084\ \textcolor{comment}{}}
\DoxyCodeLine{00085\ \textcolor{comment}{*/}}

\end{DoxyCode}
